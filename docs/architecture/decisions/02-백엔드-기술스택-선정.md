# 백엔드 기술 스택 선정

Date: 2025-01-24

## 상태

적용 중

## 맥락

프론트엔드 부분이 분리된 구조에서, api 서버 기능, 인증 인가 기능, DB와 통신 등 아래와 같은 사항이 요구된다.

<pre>
  - 여러 인프라를 통한 배포 경험 달성을 고려했을 때, 간편한 DB 변경 필요
  - 사용자의 빠르고 간편한 회원 로그인
  - 추후 다양한 기능 확장 고려 (내부 주식 모의 투자 서비스 등)
</pre>

- Spring 사용 시,

  - JPA + Hibernate => DB 변경에 보다 쉽게 대응 가능

    - 로컬환경 : h2 사용
    - 테스트 및 배포환경 : mySQL 또는 mariaDB 등
    - 추후 Radis 도입 고려

  - Spring Security + OAuth2 => 사용자의 빠르고 간편한 회원 로그인 구현 가능

  - 테스트 자동화: JUnit5와 Mockito를 활용한 단위 테스트 및 통합 테스트를 구축 가능

- [다른 대안]
  - next.js만으로도 OAuth2 부터 api 서버기능까지 지원함
    - 확장성과 보안성을 고려했을 때, Spring이 유리

## 결정

- <strong>Spring Boot </strong> 3.4.0
- <strong>Open JDK</strong> Java 21

## 결과

- 이식 가능한 서비스 추상화(PSA, Portable Service Abstraction) 활용

  - JPA와 Hibernate 조합으로 DB 유지 보수 피로 감소

  - JPA 학습에 시간과 노력이 필요

    - 테이블의 연관관계를 고려한 엔티티 설계 및 매핑 필요

      - 특히 양방향 매핑에서 setData 주의
      - 가급적 manyToOne에서만 매핑하는 전략 사용 중

    - N+1문제 발생 방지를 위해 주의 필요
      - 필요에 따라 Querydsl과 같은 도구를 활용하여 복잡한 쿼리를 최적화
      - Fetch 전략을 신중하게 설정 (페이징 처리의 어려움 발생 가능)
        - 필요한 부분은 JSQL 사용 중
        - 가급적 manyToOne연관관계 사용 중
    - 영속성 컨텍스트에서 지연로딩에 의한 의도치 않은 동작 발생 가능 (나의 이해 부족)

- 인증/인가의 효율적인 관리
  - Spring Security의 필터 기반 동작의 이해에 시간과 노력이 필요
  - 기본 제공 옵션으로 여러 해킹에 대비 가능
